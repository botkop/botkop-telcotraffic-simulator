<!DOCTYPE html>
<html lang="en">
<head>
    <script language="JavaScript">
        var websocket;

        function init() {
            try {
                websocket = new WebSocket('ws://localhost:9000/celltowers');

                websocket.onopen = function(msg) {
                    socketStatus.innerHTML = 'Connected to: ' + event.currentTarget.url;
                    socketStatus.className = 'open';
                };

                websocket.onmessage = function(msg) {
                    var message = event.data;
                    messagesList.innerHTML += '<li class="received"><span>Received:</span>' + message + '</li>';
                };

                websocket.onclose = function(msg) {
                    socketStatus.innerHTML = 'Disconnected - see error log for more information';
                };
            } catch(ex) {
                /* next statement causes selenium tests to fail */
                // console.log(ex);
            }
        }

        function sendData() {
            messagesList.innerHTML = '';
            /* force these values to be numeric, otherwise json will contain strings */
            var mcc = Number(document.getElementById("mcc").value);
            var mnc = Number(document.getElementById("mnc").value);
            var numTrips = Number(document.getElementById("numTrips").value);
            var json = { "mcc": mcc, "mnc": mnc, "numTrips": numTrips };
            websocket.send(JSON.stringify(json));
        };

    </script>
</head>

<body onload="init()">
<div id="wrap">
    <h4>Celltowers</h4>

    <ul id="socketStatus">

    </ul>
    <br>

    <p>
        MCC: <input type="text" id="mcc">
        MNC: <input type="text" id="mnc">
        # Trips: <input type="text" id="numTrips">

        <input type="submit" value="Get Celltowers" onclick="sendData()">
    </p>

    <div id="messagesList"></div>

</div>
</body>
</html>

